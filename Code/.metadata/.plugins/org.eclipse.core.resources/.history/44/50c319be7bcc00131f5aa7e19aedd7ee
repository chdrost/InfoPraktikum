/*
 * Aktualitaet.cpp
 *
 *  Created on: 25.04.2014
 *      Author: christoph
 */

#include "Aktualitaet.h"

Aktualitaet::Aktualitaet() {
	new Aktualitaet(0, 0, 0, 0, 0, 0, 0);

}

Aktualitaet::Aktualitaet(int tag, int monat, int jahr, int stunde, int minute,
		int sekunde) {
	this->zeit = new tm;
	this->zeit->tm_sec = sekunde;
	this->zeit->tm_min = minute;
	this->zeit->tm_hour = stunde;
	this->zeit->tm_mday = tag;
	this->zeit->tm_mon = monat;
	this->zeit->tm_year = jahr;
	throw new ZeitException();
}

Aktualitaet::Aktualitaet(std::string zeit) {
	int sekunde = 0;
	int minute = 0;
	int stunde = 0;
	int tag = 0;
	int monat = 0;
	int jahr = 0;
	datumEinlesen(&sekunde, &minute, &stunde, &tag, &monat, &jahr, zeit);
	this(tag, monat, jahr, stunde, minute, sekunde);
}

Aktualitaet::~Aktualitaet() {
	delete zeit;
}

int Aktualitaet::checkSekunde(int sekunde) {
	if (sekunde < 0 || sekunde > 59) {
		return 1;
	} else {
		return 0;
	}
}

int Aktualitaet::checkMinute(int minute) {
	checkSekunde(minute);
}

int Aktualitaet::checkStunde(int stunde) {
	if (stunde < 0 || stunde > 23) {
		return 1;
	} else {
		return 0;
	}
}

int Aktualitaet::checkTag(int tag) {
	if (tag < 0 || tag > 31) {
		return 1;
	} else {
		return 0;
	}
}

int Aktualitaet::checkMonat(int monat) {
	if (monat < 0 || monat > 12) {
		return 1;
	} else {
		return 0;
	}
}

int Aktualitaet::checkJahr(int jahr) {
	// Wird nicht benoetigt
	return 0;
}

void Aktualitaet::datumEinlesen(int* sekunde, int* minute, int* stunde,
		int* tag, int* monat, int* jahr, string datum) {
	string substring[6];
	int i = 0;
	for (string::iterator it = datum.iterator; it < datum.end(); it++) {
		if (isdigit(*it)) {
			substring[i] << *it;
		} else {
			i++;
		}
	}
	*sekunde = stoi(substring[5]);
	*minute = stoi(substring[4]);
	*stunde = stoi(substring[3]);
	*tag = stoi(substring[0]);
	*monat = stoi(substring[1]);
	*jahr = stoi(substring[2]);
}

void Aktualitaet::ckeckDatum(int tag, int monat, int jahr, int stunde,
		int minute, int sekunde) throw (ZeitException) {
	string fehler = "";
	int fehlerAnzahl = 0;
	if (checkSekunde(sekunde)) {
		fehler+=
				"Die Sekunden muessen 0>= sekunde <60 sein! Eingelesen wurde: "
						+= sekunde += "\n";
		fehlerAnzahl++;
	}
	if (checkMinute(minute)) {
		fehler += "Die Minuten muessen 0>= sekunde <60 sein! Eingelesen wurde: "
				+ minute + "\n";
	}
	if (checkStunde(stunde)) {
		fehler += "Die Stunden muessen 0>= sekunde <24 sein! Eingelesen wurde: "
				+ stunde + "\n";
	}
	if (checkTag(tag)) {
		fehler += "Die Tage muessen 0>= sekunde <32 sein! Eingelesen wurde: "
				+ tag + "\n";
	}
	if (checkMonat(monat)) {
		fehler += "Die Monate muessen 0>= sekunde <13 sein! Eingelesen wurde: "
				+ monat + "\n";
	}
	if (checkJahr(jahr)) {
		fehler += "Unbekannter Fehler im Jahr!\n+ Eingelesen wurde: " + jahr
				+ "\n";
	}

	//Falls ein Fehler aufgetreten ist, dann Exception mit der entsprechenden Meldung.
	if (fehlerAnzahl) {
		throw new ZeitException(fehler);
	}
}
